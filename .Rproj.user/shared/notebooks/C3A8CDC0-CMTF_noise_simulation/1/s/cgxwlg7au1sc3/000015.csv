"0","FMS_to_simulation = function(inputFac, Fac, modes){"
"0","  numComponents = ncol(Fac[[1]])"
"0","  numModes = max(unlist(modes))"
"0","  numDatasets = length(modes)"
"0","  normalizedInputFac = normalizeFac(inputFac, modes)"
"0","  normalizedFac = normalizeFac(Fac, modes)"
"0","  "
"0","  FMS_result = 1:numComponents"
"0","  for(i in 1:numComponents){"
"0","    FMS = 1"
"0","    ksi = 0"
"0","    ksi_hat = 0"
"0","    "
"0","    for(j in 1:numModes){"
"0","      vect1 = normalizedInputFac$Fac[[j]][,i]"
"0","      vect2 = normalizedFac$Fac[[j]][,i]"
"0","      FMS = FMS * (t(vect1) %*% vect2)"
"0","    }"
"0","    "
"0","    for(j in 1:numDatasets){"
"0","      ksi = ksi + normalizedInputFac$normsPerDataset[j,i]"
"0","      ksi_hat = ksi_hat + normalizedFac$normsPerDataset[j,i]"
"0","    }"
"0","    ksi_term = ((abs(ksi - ksi_hat)) / max(ksi, ksi_hat))"
"0","    "
"0","    print(FMS)"
"0","    print(ksi)"
"0","    print(ksi_hat)"
"0","    print(ksi_term)"
"0","    print(""============"")"
"0","    FMS_result[i] = (1 - ksi_term) * abs(FMS)"
"0","  }"
"0","  print(FMS_result)"
"0","  return(min(FMS_result))"
"0","}"
"0",""
"0","inputFac = list(A,B,C,D)"
"0","normalizedFac = normalizeFac(inputFac, Z_010$modes)"
"0","result = 1:length(CMTF_010)"
"0","for(i in 1:length(CMTF_010)){"
"0","  result[i] =FMS_to_simulation(inputFac, CMTF_010[[i]]$Fac, Z_010$modes)"
"0","}"
"1","    "
"1","          [,1]"
"1","
[1,]"
"1"," -1.582157e-05"
"1","
"
"1","[1]"
"1"," 349.4795"
"1","
"
"1","[1]"
"1"," 402.1076"
"1","
"
"1","[1]"
"1"," 0.1308806"
"1","
"
"1","[1]"
"1"," ""============"""
"1","
"
"1","    "
"1","         [,1]"
"1","
[1,]"
"1"," 4.566219e-05"
"1","
"
"1","[1]"
"1"," 355.6087"
"1","
"
"1","[1]"
"1"," 348.9334"
"1","
"
"1","[1]"
"1"," 0.0187716"
"1","
"
"1","[1]"
"1"," ""============"""
"1","
"
"1","    "
"1","         [,1]"
"1","
[1,]"
"1"," 0.0002418477"
"1","
"
"1","[1]"
"1"," 402.243"
"1","
"
"1","[1]"
"1"," 355.1755"
"1","
"
"1","[1]"
"1"," 0.1170126"
"1","
"
"1","[1]"
"1"," ""============"""
"1","
"
"1","[1]"
"1"," 1.375083e-05"
"1"," 4.480503e-05"
"1"," 2.135484e-04"
"1","
"
"1","    "
"1","          [,1]"
"1","
[1,]"
"1"," -1.582157e-05"
"1","
"
"1","[1]"
"1"," 349.4795"
"1","
"
"1","[1]"
"1"," 402.1076"
"1","
"
"1","[1]"
"1"," 0.1308806"
"1","
"
"1","[1]"
"1"," ""============"""
"1","
"
"1","    "
"1","         [,1]"
"1","
[1,]"
"1"," 4.566219e-05"
"1","
"
"1","[1]"
"1"," 355.6087"
"1","
"
"1","[1]"
"1"," 348.9334"
"1","
"
"1","[1]"
"1"," 0.0187716"
"1","
"
"1","[1]"
"1"," ""============"""
"1","
"
"1","    "
"1","         [,1]"
"1","
[1,]"
"1"," 0.0002418477"
"1","
"
"1","[1]"
"1"," 402.243"
"1","
"
"1","[1]"
"1"," 355.1755"
"1","
"
"1","[1]"
"1"," 0.1170126"
"1","
"
"1","[1]"
"1"," ""============"""
"1","
"
"1","[1]"
"1"," 1.375083e-05"
"1"," 4.480503e-05"
"1"," 2.135484e-04"
"1","
"
"1","    "
"1","          [,1]"
"1","
[1,]"
"1"," -1.582157e-05"
"1","
"
"1","[1]"
"1"," 349.4795"
"1","
"
"1","[1]"
"1"," 402.1076"
"1","
"
"1","[1]"
"1"," 0.1308806"
"1","
"
"1","[1]"
"1"," ""============"""
"1","
"
"1","    "
"1","         [,1]"
"1","
[1,]"
"1"," 4.566219e-05"
"1","
"
"1","[1]"
"1"," 355.6087"
"1","
"
"1","[1]"
"1"," 348.9334"
"1","
"
"1","[1]"
"1"," 0.0187716"
"1","
"
"1","[1]"
"1"," ""============"""
"1","
"
"1","    "
"1","         [,1]"
"1","
[1,]"
"1"," 0.0002418477"
"1","
"
"1","[1]"
"1"," 402.243"
"1","
"
"1","[1]"
"1"," 355.1755"
"1","
"
"1","[1]"
"1"," 0.1170126"
"1","
"
"1","[1]"
"1"," ""============"""
"1","
"
"1","[1]"
"1"," 1.375083e-05"
"1"," 4.480503e-05"
"1"," 2.135484e-04"
"1","
"
"1","    "
"1","          [,1]"
"1","
[1,]"
"1"," -1.582157e-05"
"1","
"
"1","[1]"
"1"," 349.4795"
"1","
"
"1","[1]"
"1"," 402.1076"
"1","
"
"1","[1]"
"1"," 0.1308806"
"1","
"
"1","[1]"
"1"," ""============"""
"1","
"
"1","    "
"1","         [,1]"
"1","
[1,]"
"1"," 4.566219e-05"
"1","
"
"1","[1]"
"1"," 355.6087"
"1","
"
"1","[1]"
"1"," 348.9334"
"1","
"
"1","[1]"
"1"," 0.0187716"
"1","
"
"1","[1]"
"1"," ""============"""
"1","
"
"1","    "
"1","         [,1]"
"1","
[1,]"
"1"," 0.0002418477"
"1","
"
"1","[1]"
"1"," 402.243"
"1","
"
"1","[1]"
"1"," 355.1755"
"1","
"
"1","[1]"
"1"," 0.1170126"
"1","
"
"1","[1]"
"1"," ""============"""
"1","
"
"1","[1]"
"1"," 1.375083e-05"
"1"," 4.480503e-05"
"1"," 2.135484e-04"
"1","
"
"1","    "
"1","          [,1]"
"1","
[1,]"
"1"," -1.582157e-05"
"1","
"
"1","[1]"
"1"," 349.4795"
"1","
"
"1","[1]"
"1"," 402.1076"
"1","
"
"1","[1]"
"1"," 0.1308806"
"1","
"
"1","[1]"
"1"," ""============"""
"1","
"
"1","    "
"1","         [,1]"
"1","
[1,]"
"1"," 4.566219e-05"
"1","
"
"1","[1]"
"1"," 355.6087"
"1","
"
"1","[1]"
"1"," 348.9334"
"1","
"
"1","[1]"
"1"," 0.0187716"
"1","
"
"1","[1]"
"1"," ""============"""
"1","
"
"1","    "
"1","         [,1]"
"1","
[1,]"
"1"," 0.0002418477"
"1","
"
"1","[1]"
"1"," 402.243"
"1","
"
"1","[1]"
"1"," 355.1755"
"1","
"
"1","[1]"
"1"," 0.1170126"
"1","
"
"1","[1]"
"1"," ""============"""
"1","
"
"1","[1]"
"1"," 1.375083e-05"
"1"," 4.480503e-05"
"1"," 2.135484e-04"
"1","
"
"1","    "
"1","          [,1]"
"1","
[1,]"
"1"," -1.582157e-05"
"1","
"
"1","[1]"
"1"," 349.4795"
"1","
"
"1","[1]"
"1"," 402.1076"
"1","
"
"1","[1]"
"1"," 0.1308806"
"1","
"
"1","[1]"
"1"," ""============"""
"1","
"
"1","    "
"1","         [,1]"
"1","
[1,]"
"1"," 4.566219e-05"
"1","
"
"1","[1]"
"1"," 355.6087"
"1","
"
"1","[1]"
"1"," 348.9334"
"1","
"
"1","[1]"
"1"," 0.0187716"
"1","
"
"1","[1]"
"1"," ""============"""
"1","
"
"1","    "
"1","         [,1]"
"1","
[1,]"
"1"," 0.0002418477"
"1","
"
"1","[1]"
"1"," 402.243"
"1","
"
"1","[1]"
"1"," 355.1755"
"1","
"
"1","[1]"
"1"," 0.1170126"
"1","
"
"1","[1]"
"1"," ""============"""
"1","
"
"1","[1]"
"1"," 1.375083e-05"
"1"," 4.480503e-05"
"1"," 2.135484e-04"
"1","
"
"1","    "
"1","          [,1]"
"1","
[1,]"
"1"," -1.582157e-05"
"1","
"
"1","[1]"
"1"," 349.4795"
"1","
"
"1","[1]"
"1"," 402.1076"
"1","
"
"1","[1]"
"1"," 0.1308806"
"1","
"
"1","[1]"
"1"," ""============"""
"1","
"
"1","    "
"1","         [,1]"
"1","
[1,]"
"1"," 4.566219e-05"
"1","
"
"1","[1]"
"1"," 355.6087"
"1","
"
"1","[1]"
"1"," 348.9334"
"1","
"
"1","[1]"
"1"," 0.0187716"
"1","
"
"1","[1]"
"1"," ""============"""
"1","
"
"1","    "
"1","         [,1]"
"1","
[1,]"
"1"," 0.0002418477"
"1","
"
"1","[1]"
"1"," 402.243"
"1","
"
"1","[1]"
"1"," 355.1755"
"1","
"
"1","[1]"
"1"," 0.1170126"
"1","
"
"1","[1]"
"1"," ""============"""
"1","
"
"1","[1]"
"1"," 1.375083e-05"
"1"," 4.480503e-05"
"1"," 2.135484e-04"
"1","
"
"1","    "
"1","          [,1]"
"1","
[1,]"
"1"," -1.582157e-05"
"1","
"
"1","[1]"
"1"," 349.4795"
"1","
"
"1","[1]"
"1"," 402.1076"
"1","
"
"1","[1]"
"1"," 0.1308806"
"1","
"
"1","[1]"
"1"," ""============"""
"1","
"
"1","    "
"1","         [,1]"
"1","
[1,]"
"1"," 4.566219e-05"
"1","
"
"1","[1]"
"1"," 355.6087"
"1","
"
"1","[1]"
"1"," 348.9334"
"1","
"
"1","[1]"
"1"," 0.0187716"
"1","
"
"1","[1]"
"1"," ""============"""
"1","
"
"1","    "
"1","         [,1]"
"1","
[1,]"
"1"," 0.0002418477"
"1","
"
"1","[1]"
"1"," 402.243"
"1","
"
"1","[1]"
"1"," 355.1755"
"1","
"
"1","[1]"
"1"," 0.1170126"
"1","
"
"1","[1]"
"1"," ""============"""
"1","
"
"1","[1]"
"1"," 1.375083e-05"
"1"," 4.480503e-05"
"1"," 2.135484e-04"
"1","
"
